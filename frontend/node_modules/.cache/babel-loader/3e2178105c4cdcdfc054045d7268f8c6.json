{"ast":null,"code":"import _asyncToGenerator from\"/home/sebastian/Dokumenty/GO/Projects/gomusic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/sebastian/Dokumenty/GO/Projects/gomusic/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/sebastian/Dokumenty/GO/Projects/gomusic/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/home/sebastian/Dokumenty/GO/Projects/gomusic/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/home/sebastian/Dokumenty/GO/Projects/gomusic/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/sebastian/Dokumenty/GO/Projects/gomusic/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import _regeneratorRuntime from\"/home/sebastian/Dokumenty/GO/Projects/gomusic/node_modules/@babel/runtime/regenerator/index.js\";import React from'react';import{injectStripe,StripeProvider,Elements,CardElement}from'react-stripe-elements';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var INITIALSTATE=\"INITIAL\",SUCCESSSTATE=\"COMPLETE\",FAILEDSTATE=\"FAILED\";var CreditCardForm=/*#__PURE__*/function(_React$Component){_inherits(CreditCardForm,_React$Component);var _super=_createSuper(CreditCardForm);function CreditCardForm(props){var _this;_classCallCheck(this,CreditCardForm);_this=_super.call(this,props);_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));_this.handleInputChange=_this.handleInputChange.bind(_assertThisInitialized(_this));_this.state={value:'',status:INITIALSTATE};return _this;}_createClass(CreditCardForm,[{key:\"renderCreditCardInformation\",value:function renderCreditCardInformation(){var style={base:{'fontSize':'20px','color':'#495057','fontFamily':'apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,sans-serif'}};var usersavedcard=/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-row text-center\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn  btn-outline-success text-center mx-auto\",children:\"Use saved card?\"})}),/*#__PURE__*/_jsx(\"hr\",{})]});var remembercardcheck=/*#__PURE__*/_jsxs(\"div\",{className:\"form-row form-check text-center\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",value:\"\",id:\"remembercardcheck\"}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"remembercardcheck\",children:\"Remember Card?\"})]});return/*#__PURE__*/_jsxs(\"div\",{children:[usersavedcard,/*#__PURE__*/_jsx(\"h5\",{className:\"mb-4\",children:\"Payment Info\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-12 form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"cc-name\",children:\"Name On Card:\"}),/*#__PURE__*/_jsx(\"input\",{id:\"cc-name\",name:\"cc-name\",className:\"form-control\",placeholder:\"Name on Card\",onChange:this.handleInputChange,type:\"text\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-12 form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"card\",children:\"Card Information:\"}),/*#__PURE__*/_jsx(CardElement,{id:\"card\",className:\"form-control\",style:style})]})}),remembercardcheck,/*#__PURE__*/_jsx(\"hr\",{className:\"mb-4\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-success btn-large\",children:this.props.operation})]})]});}},{key:\"renderSuccess\",value:function renderSuccess(){var _this2=this;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-4 text-success\",children:\"Credit card payment processed.....\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-success btn-large\",onClick:function onClick(){_this2.props.toggle();},children:\"Ok\"})]});}},{key:\"renderFailure\",value:function renderFailure(){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-4 text-danger\",children:\" Credit card information invalid, try again or exit\"}),this.renderCreditCardInformation()]});}},{key:\"handleSubmit\",value:function(){var _handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var id,_yield$this$props$str,token,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();id=\"\";console.log(\"Handle submit called, with name: \"+this.state.value);if(this.state.useExisting){_context.next=13;break;}_context.next=6;return this.props.stripe.createToken({name:this.state.value});case 6:_yield$this$props$str=_context.sent;token=_yield$this$props$str.token;if(!(token==null)){_context.next=12;break;}console.log(\"invalid token\");this.setState({status:FAILEDSTATE});return _context.abrupt(\"return\");case 12:id=token.id;case 13:_context.next=15;return fetch(\"/charge\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({token:id,customer_id:this.props.user,product_id:this.props.productid,sell_price:this.props.price,rememberCard:this.state.remember!==undefined,useExisting:this.state.useExisting})});case 15:response=_context.sent;console.log(response.ok);if(response.ok){console.log(\"Purchase Complete!\");this.setState({status:SUCCESSSTATE});}else{this.setState({status:FAILEDSTATE});}case 18:case\"end\":return _context.stop();}}},_callee,this);}));function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}return handleSubmit;}()},{key:\"handleInputChange\",value:function handleInputChange(event){this.setState({value:event.target.value});}},{key:\"render\",value:function render(){var body=null;switch(this.state.status){case SUCCESSSTATE:body=this.renderSuccess();break;case FAILEDSTATE:body=this.renderFailure();break;default:body=this.renderCreditCardInformation();}return/*#__PURE__*/_jsx(\"div\",{children:body});}}]);return CreditCardForm;}(React.Component);export default function CreditCardInformation(props){if(!props.show){return null;}var CCFormWithStripe=injectStripe(CreditCardForm);return/*#__PURE__*/_jsxs(\"div\",{children:[props.separator?/*#__PURE__*/_jsx(\"hr\",{}):null,/*#__PURE__*/_jsx(StripeProvider,{apiKey:\"pk_test_LwL4RUtinpP3PXzYirX2jNfR\",children:/*#__PURE__*/_jsx(Elements,{children:/*#__PURE__*/_jsx(CCFormWithStripe,{operation:props.operation})})})]});}","map":{"version":3,"sources":["/home/sebastian/Dokumenty/GO/Projects/gomusic/src/CreditCards.js"],"names":["React","injectStripe","StripeProvider","Elements","CardElement","INITIALSTATE","SUCCESSSTATE","FAILEDSTATE","CreditCardForm","props","handleSubmit","bind","handleInputChange","state","value","status","style","base","usersavedcard","remembercardcheck","operation","toggle","renderCreditCardInformation","event","preventDefault","id","console","log","useExisting","stripe","createToken","name","token","setState","fetch","method","headers","body","JSON","stringify","customer_id","user","product_id","productid","sell_price","price","rememberCard","remember","undefined","response","ok","target","renderSuccess","renderFailure","Component","CreditCardInformation","show","CCFormWithStripe","separator"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { injectStripe, StripeProvider, Elements, CardElement } from 'react-stripe-elements';\n\nconst INITIALSTATE = \"INITIAL\", SUCCESSSTATE = \"COMPLETE\", FAILEDSTATE = \"FAILED\";\n\nclass CreditCardForm extends React.Component {\n    constructor(props) {\n        super(props);\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.handleInputChange = this.handleInputChange.bind(this);\n        this.state = {\n            value: '',\n            status: INITIALSTATE\n        };\n    }\n\n    renderCreditCardInformation() {\n        const style = {\n            base: {\n                'fontSize': '20px',\n                'color': '#495057',\n                'fontFamily': 'apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,sans-serif'\n            }\n        };\n        const usersavedcard = <div>\n            <div className=\"form-row text-center\">\n                <button type=\"button\" className=\"btn  btn-outline-success text-center mx-auto\">Use saved card?</button>\n            </div>\n            <hr />\n        </div>\n\n        const remembercardcheck = <div className=\"form-row form-check text-center\">\n            <input className=\"form-check-input\" type=\"checkbox\" value=\"\" id=\"remembercardcheck\" />\n            <label className=\"form-check-label\" htmlFor=\"remembercardcheck\">\n                Remember Card?\n            </label>\n        </div>;\n        return (\n            <div>\n                {usersavedcard}\n                <h5 className=\"mb-4\">Payment Info</h5>\n                <form onSubmit={this.handleSubmit}>\n                    <div className=\"form-row\">\n                        <div className=\"col-lg-12 form-group\">\n                            <label htmlFor=\"cc-name\">Name On Card:</label>\n                            <input id=\"cc-name\" name='cc-name' className=\"form-control\" placeholder='Name on Card' onChange={this.handleInputChange} type='text' />\n                        </div>\n                    </div>\n                    <div className=\"form-row\">\n                        <div className=\"col-lg-12 form-group\">\n                            <label htmlFor=\"card\">Card Information:</label>\n                            <CardElement id=\"card\" className=\"form-control\" style={style} />\n                        </div>\n                    </div>\n                    {remembercardcheck}\n                    <hr className=\"mb-4\" />\n                    <button type=\"submit\" className=\"btn btn-success btn-large\" >{this.props.operation}</button>\n                </form>\n            </div>\n        );\n    }\n\n    renderSuccess() {\n        return (\n            <div>\n                <h5 className=\"mb-4 text-success\">Credit card payment processed.....</h5>\n                <button type=\"submit\" className=\"btn btn-success btn-large\" onClick={() => { this.props.toggle() }}>Ok</button>\n            </div>\n        );\n    }\n\n    renderFailure() {\n        return (\n            <div>\n                <h5 className=\"mb-4 text-danger\"> Credit card information invalid, try again or exit</h5>\n                {this.renderCreditCardInformation()}\n            </div>\n        );\n    }\n\n    async handleSubmit(event) {\n        \n        event.preventDefault();\n        let id = \"\";\n        console.log(\"Handle submit called, with name: \" + this.state.value);\n\n        if (!this.state.useExisting) {\n            let { token } = await this.props.stripe.createToken({ name: this.state.value });\n            if (token == null) {\n                console.log(\"invalid token\");\n                this.setState({ status: FAILEDSTATE });\n                return;\n            }\n            id = token.id;\n        }\n        let response = await fetch(\"/charge\", {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({\n                token: id,\n                customer_id: this.props.user,\n                product_id: this.props.productid,\n                sell_price: this.props.price,\n                rememberCard: this.state.remember !== undefined,\n                useExisting: this.state.useExisting\n            })\n        });\n        console.log(response.ok);\n        if (response.ok) {\n            console.log(\"Purchase Complete!\");\n            this.setState({ status: SUCCESSSTATE });\n        } else {\n            this.setState({status: FAILEDSTATE});\n        }\n    }\n\n    handleInputChange(event) {\n        this.setState({\n            value: event.target.value\n        });\n    }\n\n    render() {\n\n        let body = null;\n        switch (this.state.status) {\n            case SUCCESSSTATE:\n                body = this.renderSuccess();\n                break;\n            case FAILEDSTATE:\n                body = this.renderFailure();\n                break;\n            default:\n                body = this.renderCreditCardInformation();\n        }\n\n        return (\n            <div>\n                {body}\n            </div>\n        );\n    }\n}\n\nexport default function CreditCardInformation(props) {\n    if (!props.show) {\n        return null;\n    }\n    const CCFormWithStripe = injectStripe(CreditCardForm);\n    return (\n        <div>\n            {props.separator ? <hr /> : null}\n            <StripeProvider apiKey=\"pk_test_LwL4RUtinpP3PXzYirX2jNfR\">\n                <Elements>\n                    <CCFormWithStripe operation={props.operation} />\n                </Elements>\n            </StripeProvider>\n        </div>\n    );\n}\n\n"]},"metadata":{},"sourceType":"module"}